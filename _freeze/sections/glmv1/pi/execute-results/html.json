{
  "hash": "46410ab514ffb973a878e2667d42714d",
  "result": {
    "markdown": "---\ntitle: \"Predicting Inventory\"\nformat: \n  html:\n    code-fold: true\neditor: visual\n---\n\n\nImport Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nif (!require(\"pacman\")) {\n  install.packages(\"pacman\")\n  library(\"pacman\")\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: pacman\n```\n:::\n\n```{.r .cell-code}\n# Use p_load() to install (if necessary) and load  packages\npacman::p_load(tidyverse,\n               tidymodels,\n               leaps,\n               GGall,\n               corrplot) # for subset selection\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nInstalling package into 'C:/Users/ekoor/AppData/Local/R/win-library/4.2'\n(as 'lib' is unspecified)\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'GGall' is not available for this version of R\n\nA version of this package for your version of R might be available elsewhere,\nsee the ideas at\nhttps://cran.r-project.org/doc/manuals/r-patched/R-admin.html#Installing-packages\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: unable to access index for repository http://www.stats.ox.ac.uk/pub/RWin/bin/windows/contrib/4.2:\n  cannot open URL 'http://www.stats.ox.ac.uk/pub/RWin/bin/windows/contrib/4.2/PACKAGES'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: 'BiocManager' not available.  Could not check Bioconductor.\n\nPlease use `install.packages('BiocManager')` and then retry.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in p_install(package, character.only = TRUE, ...):\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in library(package, lib.loc = lib.loc, character.only = TRUE,\nlogical.return = TRUE, : there is no package called 'GGall'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in pacman::p_load(tidyverse, tidymodels, leaps, GGall, corrplot): Failed to install/load:\nGGall\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsetwd(\"~/gvsu/summer 23/stat 631/Collection/sections/glmv1\")\ninventory1 <-  read.csv(\"inventory.csv\")\n```\n:::\n\n\nmake new variable for 6 week sales periods\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninventory <-  inventory1 %>% \n  mutate(sales_period = cut(week, breaks = seq(0, 54, 9), labels = FALSE, include.lowest = TRUE))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate total sales for each item in each chunk -->\ninventory <- inventory %>%\ngroup_by(item_no, sales_period) %>%\nsummarise(sold = sum(sold, na.rm = TRUE), .groups = \"drop\") \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the yearly total for each item\ninventory_sum <- inventory %>%\n  group_by(item_no) %>%\n  summarise(year_total = sum(sold), .groups = \"drop\")\n\n# Join this back to the original data frame\ninventory <- left_join(inventory, inventory_sum, by = c(\"item_no\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninventory <- inventory %>% \n  mutate(share_of_year = round((sold/year_total) * 100, 1))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninventory %>% \n  ggplot(aes(x = share_of_year)) +\n  geom_histogram( bins = 30)\n```\n\n::: {.cell-output-display}\n![](pi_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninventory <- inventory %>% \n  mutate(only_season = ifelse(share_of_year >= 90, 1, 0))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninventory <- inventory %>% \n  mutate(in_season = ifelse(share_of_year >= 60, 1, 0))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninventory <- inventory %>%\n  group_by(item_no) %>%\n  mutate(year_round = ifelse(all(share_of_year <= 25), 1, 0))\n```\n:::\n\n\nbest sellers\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the top 10% threshold\ntop_10_threshold <- quantile(inventory$year_total, 0.9)\n\n# Create the 'hv_product' column\ninventory <- inventory %>% \n  mutate(best_seller = ifelse(year_total >= top_10_threshold, 1, 0))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# did sales go up from the last sales period?\ninventory <- inventory %>%\n  group_by(item_no) %>%\n  mutate(up = ifelse(sold > lag(sold, default = first(sold)), 1, 0))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninventory <-  inventory %>% \n  select(-year_total)\n```\n:::\n\n\ntips make sure all of the weeks are in the training data set test the model on one inventory item try a few different models\n\nLook at the time with the most sales High-sales items often have more data points available, which can lead to better model training and evaluation. More data allows the model to learn patterns and trends more effectively\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbest_sold <-  inventory %>% \n  filter(best_seller == 1) %>% \n  select(-share_of_year, -best_seller, - only_season)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Identify non-numeric columns\nnon_numeric_cols <- sapply(best_sold, FUN = function(col) !is.numeric(col))\n\n# Print non-numeric column names\ncat(\"Non-numeric columns:\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nNon-numeric columns:\n```\n:::\n\n```{.r .cell-code}\nprint(names(best_sold)[non_numeric_cols])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"item_no\"\n```\n:::\n\n```{.r .cell-code}\n# Exclude non-numeric columns\nbest_sold_numeric <- best_sold[, !non_numeric_cols]\n\n# Compute correlation matrix\ncorrelation_matrix <- cor(best_sold_numeric, use = \"complete.obs\")\n\ncorrplot(correlation_matrix, method = \"color\")\n```\n\n::: {.cell-output-display}\n![](pi_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncorrelation_matrix\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             sales_period        sold   in_season   year_round          up\nsales_period   1.00000000 -0.09336829 -0.02972629  0.000000000 0.108302000\nsold          -0.09336829  1.00000000  0.15073709  0.186136386 0.210992608\nin_season     -0.02972629  0.15073709  1.00000000 -0.122263869 0.137237963\nyear_round     0.00000000  0.18613639 -0.12226387  1.000000000 0.006498531\nup             0.10830200  0.21099261  0.13723796  0.006498531 1.000000000\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbest_sold %>%\n  ggplot(aes(y = sold, x = sales_period, group = sales_period)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](pi_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nregsubsets runs through many methods when should i split the data? why are my inventory items turned into variables? should i convert my item numbers into dummy variables? what's a cp value? you want the smallest cp you want the larger r squared\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#https://www.youtube.com/watch?v=IScjygOnO0w\n# try to predict sold based on all of the variables\nset.seed(3736)\nbest_model <- regsubsets(sold ~ ., data = best_sold, really.big = TRUE, nbest=5, nvmax = 5, method = \"backward\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in leaps.setup(x, y, wt = wt, nbest = nbest, nvmax = nvmax, force.in =\nforce.in, : 1 linear dependencies found\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nReordering variables and trying again:\n```\n:::\n\n```{.r .cell-code}\nbest_summary <-  with(summary(best_model), data.frame(rsq, adjr2, cp, rss, outmat))\nbest_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  rsq        adjr2       cp        rss item_no153.2424\n1  ( 1 ) 0.3463944218  0.344156047 456.3893 1172981631                \n1  ( 2 ) 0.0414096153  0.038126772 804.6687 1720317191                \n1  ( 3 ) 0.0007795172 -0.002642471 851.0666 1793233274               *\n2  ( 1 ) 0.4570496325  0.453318015 332.0258  974396224                \n2  ( 2 ) 0.3929648735  0.388792811 405.2078 1089404797                \n2  ( 3 ) 0.0469762751  0.040426284 800.3119 1710327084                \n2  ( 4 ) 0.0460107686  0.039454142 801.4144 1712059813                \n2  ( 5 ) 0.0423979420  0.035816485 805.5401 1718543508                \n3  ( 1 ) 0.5117264953  0.506675390 271.5872  876271364                \n3  ( 2 ) 0.5089427068  0.503862804 274.7662  881267241                \n3  ( 3 ) 0.5067474082  0.501644795 277.2731  885206994                \n3  ( 4 ) 0.4217570573  0.415775234 374.3284 1037733417                \n3  ( 5 ) 0.3968099584  0.390570061 402.8169 1082504284                \n4  ( 1 ) 0.5701702379  0.564221037 206.8470  771386341                \n4  ( 2 ) 0.5608975410  0.554819998 217.4360  788027421                \n4  ( 3 ) 0.5380967350  0.531703610 243.4735  828946482                \n4  ( 4 ) 0.4251598875  0.417203623 372.4425 1031626588                \n4  ( 5 ) 0.4014724447  0.393188326 399.4926 1074136836                \n5  ( 1 ) 0.6231248555  0.616581884 148.3751  676352278                \n5  ( 2 ) 0.5941211967  0.587074690 181.4960  728403178                \n5  ( 3 ) 0.5406739857  0.532699576 242.5304  824321265                \n5  ( 4 ) 0.4264743087  0.416517265 372.9415 1029267685                \n5  ( 5 ) 0.4041949017  0.393851063 398.3836 1069251027                \n6  ( 1 ) 0.6571731597  0.650006048 111.4934  615248094                \n6  ( 2 ) 0.6245353698  0.616685935 148.7644  673820923                \n6  ( 3 ) 0.6028388337  0.594535813 173.5409  712758226                \n6  ( 4 ) 0.5961822593  0.587740077 181.1424  724704329                \n6  ( 5 ) 0.5414883985  0.531902790 243.6004  822859694                \n         item_no154.2424 item_no200830 item_no200833 item_no255002424\n1  ( 1 )                                                             \n1  ( 2 )                             *                               \n1  ( 3 )                                                             \n2  ( 1 )                                                             \n2  ( 2 )                             *                               \n2  ( 3 )                             *                               \n2  ( 4 )                             *             *                 \n2  ( 5 )                             *                              *\n3  ( 1 )                                                             \n3  ( 2 )                                                             \n3  ( 3 )                             *                               \n3  ( 4 )                             *                               \n3  ( 5 )                             *                               \n4  ( 1 )                                                             \n4  ( 2 )                             *                               \n4  ( 3 )                             *                               \n4  ( 4 )                             *                               \n4  ( 5 )                             *                               \n5  ( 1 )                             *                               \n5  ( 2 )                             *                               \n5  ( 3 )                             *                               \n5  ( 4 )                             *                               \n5  ( 5 )                             *                               \n6  ( 1 )                             *                               \n6  ( 2 )                             *                               \n6  ( 3 )                             *                               \n6  ( 4 )                             *                               \n6  ( 5 )                             *                               \n         item_no299242401 item_no41169 item_no41250 item_noA510004\n1  ( 1 )                                                         *\n1  ( 2 )                                                          \n1  ( 3 )                                                          \n2  ( 1 )                                                         *\n2  ( 2 )                                                         *\n2  ( 3 )                *                                         \n2  ( 4 )                                                          \n2  ( 5 )                                                          \n3  ( 1 )                                                         *\n3  ( 2 )                                                         *\n3  ( 3 )                                                         *\n3  ( 4 )                                                         *\n3  ( 5 )                *                                        *\n4  ( 1 )                                                         *\n4  ( 2 )                                                         *\n4  ( 3 )                                                         *\n4  ( 4 )                *                                        *\n4  ( 5 )                *            *                           *\n5  ( 1 )                                                         *\n5  ( 2 )                                                         *\n5  ( 3 )                *                                        *\n5  ( 4 )                *                                        *\n5  ( 5 )                *            *                           *\n6  ( 1 )                                                         *\n6  ( 2 )                                                         *\n6  ( 3 )                                                         *\n6  ( 4 )                *                                        *\n6  ( 5 )                *                                        *\n         item_noBF000230.167 item_noBPONG1P2PWE item_noBPONG25P2PWE\n1  ( 1 )                                                           \n1  ( 2 )                                                           \n1  ( 3 )                                                           \n2  ( 1 )                                                           \n2  ( 2 )                                                           \n2  ( 3 )                                                           \n2  ( 4 )                                                           \n2  ( 5 )                                                           \n3  ( 1 )                                                           \n3  ( 2 )                                                           \n3  ( 3 )                                                           \n3  ( 4 )                                                           \n3  ( 5 )                                                           \n4  ( 1 )                                                           \n4  ( 2 )                                                           \n4  ( 3 )                                                           \n4  ( 4 )                                                           \n4  ( 5 )                                                           \n5  ( 1 )                                                           \n5  ( 2 )                                                           \n5  ( 3 )                                                           \n5  ( 4 )                                                           \n5  ( 5 )                                                           \n6  ( 1 )                                                           \n6  ( 2 )                                                           \n6  ( 3 )                                                           \n6  ( 4 )                                                           \n6  ( 5 )                                                           \n         item_noBPONG50P2PWE item_noDP40.STD.16252 item_noDP40.STD.20202\n1  ( 1 )                                                                \n1  ( 2 )                                                                \n1  ( 3 )                                                                \n2  ( 1 )                                                                \n2  ( 2 )                                                                \n2  ( 3 )                                                                \n2  ( 4 )                                                                \n2  ( 5 )                                                                \n3  ( 1 )                                                                \n3  ( 2 )                                                                \n3  ( 3 )                                                                \n3  ( 4 )                                                                \n3  ( 5 )                                                                \n4  ( 1 )                                                                \n4  ( 2 )                                                                \n4  ( 3 )                                                                \n4  ( 4 )                                                                \n4  ( 5 )                                                                \n5  ( 1 )                                                                \n5  ( 2 )                                                                \n5  ( 3 )                                                                \n5  ( 4 )                                                                \n5  ( 5 )                                                               *\n6  ( 1 )                                                                \n6  ( 2 )                                                                \n6  ( 3 )                                                                \n6  ( 4 )                                                                \n6  ( 5 )                                                                \n         item_noDP40.STD.20252 item_noDP40.STD.24242 item_noDP40.STD.24244\n1  ( 1 )                                                                  \n1  ( 2 )                                                                  \n1  ( 3 )                                                                  \n2  ( 1 )                                                                  \n2  ( 2 )                                                                  \n2  ( 3 )                                                                  \n2  ( 4 )                                                                  \n2  ( 5 )                                                                  \n3  ( 1 )                                                                  \n3  ( 2 )                                                                  \n3  ( 3 )                                                                  \n3  ( 4 )                                                                  \n3  ( 5 )                                                                  \n4  ( 1 )                                                                  \n4  ( 2 )                                                                  \n4  ( 3 )                                                                  \n4  ( 4 )                                                                  \n4  ( 5 )                                                                  \n5  ( 1 )                                                                  \n5  ( 2 )                                                                  \n5  ( 3 )                                                                  \n5  ( 4 )                                                                 *\n5  ( 5 )                                                                  \n6  ( 1 )                                                                  \n6  ( 2 )                                                                  \n6  ( 3 )                                                                  \n6  ( 4 )                                                                  \n6  ( 5 )                                                                 *\n         item_noMX40.STD.16201 item_noMX40.STD.16202 item_noMX40.STD.16252\n1  ( 1 )                                                                  \n1  ( 2 )                                                                  \n1  ( 3 )                                                                  \n2  ( 1 )                                                                  \n2  ( 2 )                                                                  \n2  ( 3 )                                                                  \n2  ( 4 )                                                                  \n2  ( 5 )                                                                  \n3  ( 1 )                                                                  \n3  ( 2 )                                                                  \n3  ( 3 )                                                                  \n3  ( 4 )                                                                  \n3  ( 5 )                                                                  \n4  ( 1 )                                                                  \n4  ( 2 )                                                                  \n4  ( 3 )                                                                  \n4  ( 4 )                                                                  \n4  ( 5 )                                                                  \n5  ( 1 )                                                                  \n5  ( 2 )                                                                  \n5  ( 3 )                                                                  \n5  ( 4 )                                                                  \n5  ( 5 )                                                                  \n6  ( 1 )                                                                  \n6  ( 2 )                                                                  \n6  ( 3 )                                                                  \n6  ( 4 )                                                                  \n6  ( 5 )                                                                  \n         item_noMX40.STD.20201 item_noMX40.STD.20202 item_noMX40.STD.20242\n1  ( 1 )                                                                  \n1  ( 2 )                                                                  \n1  ( 3 )                                                                  \n2  ( 1 )                                                                  \n2  ( 2 )                                                                  \n2  ( 3 )                                                                  \n2  ( 4 )                                                                  \n2  ( 5 )                                                                  \n3  ( 1 )                                                                  \n3  ( 2 )                                                                  \n3  ( 3 )                                                                  \n3  ( 4 )                                                                  \n3  ( 5 )                                                                  \n4  ( 1 )                                                                  \n4  ( 2 )                                                                  \n4  ( 3 )                                                                  \n4  ( 4 )                                                                  \n4  ( 5 )                                                                  \n5  ( 1 )                                                                  \n5  ( 2 )                                                                  \n5  ( 3 )                                                                  \n5  ( 4 )                                                                  \n5  ( 5 )                                                                  \n6  ( 1 )                                                                  \n6  ( 2 )                                                                  \n6  ( 3 )                                                                  \n6  ( 4 )                                                                  \n6  ( 5 )                                                                  \n         item_noMX40.STD.20252 item_noMX40.STD.24242 item_noMX40.STD.24244\n1  ( 1 )                                                                  \n1  ( 2 )                                                                  \n1  ( 3 )                                                                  \n2  ( 1 )                                           *                      \n2  ( 2 )                                                                  \n2  ( 3 )                                                                  \n2  ( 4 )                                                                  \n2  ( 5 )                                                                  \n3  ( 1 )                                           *                      \n3  ( 2 )                                           *                      \n3  ( 3 )                                           *                      \n3  ( 4 )                     *                                            \n3  ( 5 )                                                                  \n4  ( 1 )                                           *                      \n4  ( 2 )                                           *                      \n4  ( 3 )                     *                     *                      \n4  ( 4 )                     *                                            \n4  ( 5 )                                                                  \n5  ( 1 )                                           *                      \n5  ( 2 )                     *                     *                      \n5  ( 3 )                     *                     *                      \n5  ( 4 )                     *                                            \n5  ( 5 )                                                                  \n6  ( 1 )                     *                     *                      \n6  ( 2 )                     *                     *                      \n6  ( 3 )                     *                     *                      \n6  ( 4 )                     *                     *                      \n6  ( 5 )                     *                     *                      \n         item_noNMO200P4SH.A.AJR item_noP.020X02015SW100 item_noPA.3.20X20.NA\n1  ( 1 )                                                                     \n1  ( 2 )                                                                     \n1  ( 3 )                                                                     \n2  ( 1 )                                                                     \n2  ( 2 )                                                                     \n2  ( 3 )                                                                     \n2  ( 4 )                                                                     \n2  ( 5 )                                                                     \n3  ( 1 )                                                                     \n3  ( 2 )                                               *                     \n3  ( 3 )                                                                     \n3  ( 4 )                                                                     \n3  ( 5 )                                                                     \n4  ( 1 )                                               *                     \n4  ( 2 )                                               *                     \n4  ( 3 )                                                                     \n4  ( 4 )                                                                     \n4  ( 5 )                                                                     \n5  ( 1 )                                               *                     \n5  ( 2 )                                               *                     \n5  ( 3 )                                                                     \n5  ( 4 )                                                                     \n5  ( 5 )                                                                     \n6  ( 1 )                                               *                     \n6  ( 2 )                                               *                     \n6  ( 3 )                                               *                     \n6  ( 4 )                                               *                     \n6  ( 5 )                                                                     \n         item_noPES10P3SH.AJR item_noPES1P2SH.30.AJR item_noPES1P2SH.AJR\n1  ( 1 )                                                                \n1  ( 2 )                                                                \n1  ( 3 )                                                                \n2  ( 1 )                                                                \n2  ( 2 )                                                                \n2  ( 3 )                                                                \n2  ( 4 )                                                                \n2  ( 5 )                                                                \n3  ( 1 )                                                                \n3  ( 2 )                                                                \n3  ( 3 )                                                                \n3  ( 4 )                                                                \n3  ( 5 )                                                                \n4  ( 1 )                                                                \n4  ( 2 )                                                                \n4  ( 3 )                                                                \n4  ( 4 )                                                                \n4  ( 5 )                                                                \n5  ( 1 )                                                                \n5  ( 2 )                                                                \n5  ( 3 )                                                                \n5  ( 4 )                                                                \n5  ( 5 )                                                                \n6  ( 1 )                                                                \n6  ( 2 )                                                                \n6  ( 3 )                                                                \n6  ( 4 )                                                                \n6  ( 5 )                                                                \n         item_noPES1P2SSH.AJR item_noPES25P2F.WE.AJR item_noPOG10P2F.WE.AJR\n1  ( 1 )                                                                   \n1  ( 2 )                                                                   \n1  ( 3 )                                                                   \n2  ( 1 )                                                                   \n2  ( 2 )                                                                   \n2  ( 3 )                                                                   \n2  ( 4 )                                                                   \n2  ( 5 )                                                                   \n3  ( 1 )                                                                   \n3  ( 2 )                                                                   \n3  ( 3 )                                                                   \n3  ( 4 )                                                                   \n3  ( 5 )                                                                   \n4  ( 1 )                                                                   \n4  ( 2 )                                                                   \n4  ( 3 )                                                                   \n4  ( 4 )                                                                   \n4  ( 5 )                                                                   \n5  ( 1 )                                                                   \n5  ( 2 )                                                                   \n5  ( 3 )                                                                   \n5  ( 4 )                                                                   \n5  ( 5 )                                                                   \n6  ( 1 )                                                                   \n6  ( 2 )                                                                   \n6  ( 3 )                                                                   \n6  ( 4 )                                                                   \n6  ( 5 )                                                                   \n         item_noPOG15RP2P.AJR item_noPOG25RP2P.AJR item_noPOG3P2SSH.AJR\n1  ( 1 )                                                               \n1  ( 2 )                                                               \n1  ( 3 )                                                               \n2  ( 1 )                                                               \n2  ( 2 )                                                               \n2  ( 3 )                                                               \n2  ( 4 )                                                               \n2  ( 5 )                                                               \n3  ( 1 )                                                               \n3  ( 2 )                                                               \n3  ( 3 )                                                               \n3  ( 4 )                                                               \n3  ( 5 )                                                               \n4  ( 1 )                                                               \n4  ( 2 )                                                               \n4  ( 3 )                                                               \n4  ( 4 )                                                               \n4  ( 5 )                                                               \n5  ( 1 )                                                               \n5  ( 2 )                                                               \n5  ( 3 )                                                               \n5  ( 4 )                                                               \n5  ( 5 )                                                               \n6  ( 1 )                                                               \n6  ( 2 )                                                               \n6  ( 3 )                                                               \n6  ( 4 )                                                               \n6  ( 5 )                                                               \n         item_noPOG5RP1P.AJR item_noPP.020.020.030 item_noVL.EC.PD.82515\n1  ( 1 )                                                                \n1  ( 2 )                                                                \n1  ( 3 )                                                                \n2  ( 1 )                                                                \n2  ( 2 )                                                                \n2  ( 3 )                                                                \n2  ( 4 )                                                                \n2  ( 5 )                                                                \n3  ( 1 )                                                                \n3  ( 2 )                                                                \n3  ( 3 )                                                                \n3  ( 4 )                                                                \n3  ( 5 )                                                                \n4  ( 1 )                                                                \n4  ( 2 )                                                                \n4  ( 3 )                                                                \n4  ( 4 )                                                                \n4  ( 5 )                                                                \n5  ( 1 )                                                                \n5  ( 2 )                                                                \n5  ( 3 )                                                                \n5  ( 4 )                                                                \n5  ( 5 )                                                                \n6  ( 1 )                                                                \n6  ( 2 )                                                                \n6  ( 3 )                                                                \n6  ( 4 )                                                                \n6  ( 5 )                                                                \n         item_noXP.STD.16202 item_noXP.STD.16252 item_noXP.STD.20202\n1  ( 1 )                                                            \n1  ( 2 )                                                            \n1  ( 3 )                                                            \n2  ( 1 )                                                            \n2  ( 2 )                                                            \n2  ( 3 )                                                            \n2  ( 4 )                                                            \n2  ( 5 )                                                            \n3  ( 1 )                                                            \n3  ( 2 )                                                            \n3  ( 3 )                                                            \n3  ( 4 )                                                            \n3  ( 5 )                                                            \n4  ( 1 )                                                            \n4  ( 2 )                                                            \n4  ( 3 )                                                            \n4  ( 4 )                                                            \n4  ( 5 )                                                            \n5  ( 1 )                                                            \n5  ( 2 )                                                            \n5  ( 3 )                                                            \n5  ( 4 )                                                            \n5  ( 5 )                                                            \n6  ( 1 )                                                            \n6  ( 2 )                                                            \n6  ( 3 )                                                            \n6  ( 4 )                                                            \n6  ( 5 )                                                            \n         item_noXP.STD.20252 item_noXP.STD.24242 item_noXPH.STD.24242\n1  ( 1 )                                                             \n1  ( 2 )                                                             \n1  ( 3 )                                                             \n2  ( 1 )                                                             \n2  ( 2 )                                                             \n2  ( 3 )                                                             \n2  ( 4 )                                                             \n2  ( 5 )                                                             \n3  ( 1 )                                                             \n3  ( 2 )                                                             \n3  ( 3 )                                                             \n3  ( 4 )                                                             \n3  ( 5 )                                                             \n4  ( 1 )                                                             \n4  ( 2 )                                                             \n4  ( 3 )                                                             \n4  ( 4 )                                                             \n4  ( 5 )                                                             \n5  ( 1 )                                                             \n5  ( 2 )                                                             \n5  ( 3 )                                                             \n5  ( 4 )                                                             \n5  ( 5 )                                                             \n6  ( 1 )                                                             \n6  ( 2 )                                                             \n6  ( 3 )                                                             \n6  ( 4 )                                                             \n6  ( 5 )                                                             \n         sales_period in_season year_round up\n1  ( 1 )                                     \n1  ( 2 )                                     \n1  ( 3 )                                     \n2  ( 1 )                                     \n2  ( 2 )                                     \n2  ( 3 )                                     \n2  ( 4 )                                     \n2  ( 5 )                                     \n3  ( 1 )                                    *\n3  ( 2 )                                     \n3  ( 3 )                                     \n3  ( 4 )                                     \n3  ( 5 )                                     \n4  ( 1 )                                    *\n4  ( 2 )                                     \n4  ( 3 )                                     \n4  ( 4 )                                     \n4  ( 5 )                                     \n5  ( 1 )                                    *\n5  ( 2 )                                     \n5  ( 3 )                                     \n5  ( 4 )                                     \n5  ( 5 )                                     \n6  ( 1 )                                    *\n6  ( 2 )                      *              \n6  ( 3 )            *                        \n6  ( 4 )                                     \n6  ( 5 )                                     \n```\n:::\n:::\n\n\ntips from the book Subset Selection Choosing the Optimal Mode The AIC criterion is defined for models fit by maximum likelihood.\n\n\"To perform best subset selection, we fit a separate least squares regression best subset selection for each possible combination of the p predictors.\"\n\nfeature selection\n\nwhat;s coorelated\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(3736)\n# forward Stepwise Selection\n# nvmax = 8 specifies the maximum number of predictors to incorporate in the model.\nbest_mod <- regsubsets(sold ~  .,\n                       data = best_sold, nbest = 2, method = \"forward\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in leaps.setup(x, y, wt = wt, nbest = nbest, nvmax = nvmax, force.in =\nforce.in, : 1 linear dependencies found\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nReordering variables and trying again:\n```\n:::\n\n```{.r .cell-code}\nbest_mod_summary <- with(summary(best_mod), data.frame(rsq,adjr2, cp, rss, outmat))\n\n# Print summary\nbest_mod_summary\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               rsq      adjr2        cp        rss item_no153.2424\n1  ( 1 ) 0.3463944 0.34415605 456.38929 1172981631                \n1  ( 2 ) 0.1026017 0.09952846 734.78998 1610499831                \n2  ( 1 ) 0.4570496 0.45331801 332.02582  974396224                \n2  ( 2 ) 0.3950903 0.39093279 402.78076 1085590528                \n3  ( 1 ) 0.5117265 0.50667539 271.58721  876271364                \n3  ( 2 ) 0.5089427 0.50386280 274.76618  881267241                \n4  ( 1 ) 0.5701702 0.56422104 206.84699  771386341                \n4  ( 2 ) 0.5622131 0.55615372 215.93375  785666559                \n5  ( 1 ) 0.6231249 0.61658188 148.37511  676352278                \n5  ( 2 ) 0.6023345 0.59543060 172.11677  713663285                \n6  ( 1 ) 0.6571732 0.65000605 111.49342  615248094                \n6  ( 2 ) 0.6424107 0.63493493 128.35154  641741339                \n7  ( 1 ) 0.6772346 0.66933470  90.58417  579245271                \n7  ( 2 ) 0.6726082 0.66459513  95.86725  587547843                \n8  ( 1 ) 0.6934682 0.68486381  74.04603  550111820                \n8  ( 2 ) 0.6918472 0.68319725  75.89722  553021030                \n9  ( 1 ) 0.7088873 0.69966192  58.43808  522440190                \n9  ( 2 ) 0.7065534 0.69725402  61.10334  526628756                \n         item_no154.2424 item_no200830 item_no200833 item_no255002424\n1  ( 1 )                                                             \n1  ( 2 )                                                             \n2  ( 1 )                                                             \n2  ( 2 )                                                             \n3  ( 1 )                                                             \n3  ( 2 )                                                             \n4  ( 1 )                                                             \n4  ( 2 )                             *                               \n5  ( 1 )                             *                               \n5  ( 2 )                                                             \n6  ( 1 )                             *                               \n6  ( 2 )                             *                               \n7  ( 1 )                             *                               \n7  ( 2 )                             *                               \n8  ( 1 )                             *                               \n8  ( 2 )                             *                               \n9  ( 1 )                             *                               \n9  ( 2 )                             *                               \n         item_no299242401 item_no41169 item_no41250 item_noA510004\n1  ( 1 )                                                         *\n1  ( 2 )                                                          \n2  ( 1 )                                                         *\n2  ( 2 )                                                         *\n3  ( 1 )                                                         *\n3  ( 2 )                                                         *\n4  ( 1 )                                                         *\n4  ( 2 )                                                         *\n5  ( 1 )                                                         *\n5  ( 2 )                                                         *\n6  ( 1 )                                                         *\n6  ( 2 )                                                         *\n7  ( 1 )                                                         *\n7  ( 2 )                                                         *\n8  ( 1 )                                                         *\n8  ( 2 )                                                         *\n9  ( 1 )                                                         *\n9  ( 2 )                                                         *\n         item_noBF000230.167 item_noBPONG1P2PWE item_noBPONG25P2PWE\n1  ( 1 )                                                           \n1  ( 2 )                                                           \n2  ( 1 )                                                           \n2  ( 2 )                                                           \n3  ( 1 )                                                           \n3  ( 2 )                                                           \n4  ( 1 )                                                           \n4  ( 2 )                                                           \n5  ( 1 )                                                           \n5  ( 2 )                                                           \n6  ( 1 )                                                           \n6  ( 2 )                                                           \n7  ( 1 )                                                           \n7  ( 2 )                                                           \n8  ( 1 )                                                           \n8  ( 2 )                                                           \n9  ( 1 )                                                           \n9  ( 2 )                                                           \n         item_noBPONG50P2PWE item_noDP40.STD.16252 item_noDP40.STD.20202\n1  ( 1 )                                                                \n1  ( 2 )                                                                \n2  ( 1 )                                                                \n2  ( 2 )                                                                \n3  ( 1 )                                                                \n3  ( 2 )                                                                \n4  ( 1 )                                                                \n4  ( 2 )                                                                \n5  ( 1 )                                                                \n5  ( 2 )                                                                \n6  ( 1 )                                                                \n6  ( 2 )                                                                \n7  ( 1 )                                                                \n7  ( 2 )                                                                \n8  ( 1 )                                                                \n8  ( 2 )                                                                \n9  ( 1 )                                                                \n9  ( 2 )                                                                \n         item_noDP40.STD.20252 item_noDP40.STD.24242 item_noDP40.STD.24244\n1  ( 1 )                                                                  \n1  ( 2 )                                                                  \n2  ( 1 )                                                                  \n2  ( 2 )                                                                  \n3  ( 1 )                                                                  \n3  ( 2 )                                                                  \n4  ( 1 )                                                                  \n4  ( 2 )                                                                  \n5  ( 1 )                                                                  \n5  ( 2 )                                                                  \n6  ( 1 )                                                                  \n6  ( 2 )                                                                  \n7  ( 1 )                                                                  \n7  ( 2 )                                                                  \n8  ( 1 )                                                                  \n8  ( 2 )                                                                  \n9  ( 1 )                                                                  \n9  ( 2 )                                                                  \n         item_noMX40.STD.16201 item_noMX40.STD.16202 item_noMX40.STD.16252\n1  ( 1 )                                                                  \n1  ( 2 )                                                                  \n2  ( 1 )                                                                  \n2  ( 2 )                                                                  \n3  ( 1 )                                                                  \n3  ( 2 )                                                                  \n4  ( 1 )                                                                  \n4  ( 2 )                                                                  \n5  ( 1 )                                                                  \n5  ( 2 )                                                                  \n6  ( 1 )                                                                  \n6  ( 2 )                                                                  \n7  ( 1 )                                                                  \n7  ( 2 )                                                                  \n8  ( 1 )                                                                  \n8  ( 2 )                                           *                      \n9  ( 1 )                                           *                      \n9  ( 2 )                                                                  \n         item_noMX40.STD.20201 item_noMX40.STD.20202 item_noMX40.STD.20242\n1  ( 1 )                                                                  \n1  ( 2 )                                                                  \n2  ( 1 )                                                                  \n2  ( 2 )                                                                  \n3  ( 1 )                                                                  \n3  ( 2 )                                                                  \n4  ( 1 )                                                                  \n4  ( 2 )                                                                  \n5  ( 1 )                                                                  \n5  ( 2 )                                                                  \n6  ( 1 )                                                                  \n6  ( 2 )                                                                  \n7  ( 1 )                                                                  \n7  ( 2 )                                           *                      \n8  ( 1 )                                           *                      \n8  ( 2 )                                                                  \n9  ( 1 )                                           *                      \n9  ( 2 )                                           *                      \n         item_noMX40.STD.20252 item_noMX40.STD.24242 item_noMX40.STD.24244\n1  ( 1 )                                                                  \n1  ( 2 )                                           *                      \n2  ( 1 )                                           *                      \n2  ( 2 )                                                                  \n3  ( 1 )                                           *                      \n3  ( 2 )                                           *                      \n4  ( 1 )                                           *                      \n4  ( 2 )                                           *                      \n5  ( 1 )                                           *                      \n5  ( 2 )                     *                     *                      \n6  ( 1 )                     *                     *                      \n6  ( 2 )                                           *                      \n7  ( 1 )                     *                     *                      \n7  ( 2 )                     *                     *                      \n8  ( 1 )                     *                     *                      \n8  ( 2 )                     *                     *                      \n9  ( 1 )                     *                     *                      \n9  ( 2 )                     *                     *                      \n         item_noNMO200P4SH.A.AJR item_noP.020X02015SW100 item_noPA.3.20X20.NA\n1  ( 1 )                                                                     \n1  ( 2 )                                                                     \n2  ( 1 )                                                                     \n2  ( 2 )                                               *                     \n3  ( 1 )                                                                     \n3  ( 2 )                                               *                     \n4  ( 1 )                                               *                     \n4  ( 2 )                                                                     \n5  ( 1 )                                               *                     \n5  ( 2 )                                               *                     \n6  ( 1 )                                               *                     \n6  ( 2 )                                               *                     \n7  ( 1 )                                               *                     \n7  ( 2 )                                               *                     \n8  ( 1 )                                               *                     \n8  ( 2 )                                               *                     \n9  ( 1 )                                               *                     \n9  ( 2 )                                               *                     \n         item_noPES10P3SH.AJR item_noPES1P2SH.30.AJR item_noPES1P2SH.AJR\n1  ( 1 )                                                                \n1  ( 2 )                                                                \n2  ( 1 )                                                                \n2  ( 2 )                                                                \n3  ( 1 )                                                                \n3  ( 2 )                                                                \n4  ( 1 )                                                                \n4  ( 2 )                                                                \n5  ( 1 )                                                                \n5  ( 2 )                                                                \n6  ( 1 )                                                                \n6  ( 2 )                                                                \n7  ( 1 )                                                                \n7  ( 2 )                                                                \n8  ( 1 )                                                                \n8  ( 2 )                                                                \n9  ( 1 )                                                                \n9  ( 2 )                                                                \n         item_noPES1P2SSH.AJR item_noPES25P2F.WE.AJR item_noPOG10P2F.WE.AJR\n1  ( 1 )                                                                   \n1  ( 2 )                                                                   \n2  ( 1 )                                                                   \n2  ( 2 )                                                                   \n3  ( 1 )                                                                   \n3  ( 2 )                                                                   \n4  ( 1 )                                                                   \n4  ( 2 )                                                                   \n5  ( 1 )                                                                   \n5  ( 2 )                                                                   \n6  ( 1 )                                                                   \n6  ( 2 )                                                                   \n7  ( 1 )                                                                   \n7  ( 2 )                                                                   \n8  ( 1 )                                                                   \n8  ( 2 )                                                                   \n9  ( 1 )                                                                   \n9  ( 2 )                                                                   \n         item_noPOG15RP2P.AJR item_noPOG25RP2P.AJR item_noPOG3P2SSH.AJR\n1  ( 1 )                                                               \n1  ( 2 )                                                               \n2  ( 1 )                                                               \n2  ( 2 )                                                               \n3  ( 1 )                                                               \n3  ( 2 )                                                               \n4  ( 1 )                                                               \n4  ( 2 )                                                               \n5  ( 1 )                                                               \n5  ( 2 )                                                               \n6  ( 1 )                                                               \n6  ( 2 )                                                               \n7  ( 1 )                                                               \n7  ( 2 )                                                               \n8  ( 1 )                                                               \n8  ( 2 )                                                               \n9  ( 1 )                                                               \n9  ( 2 )                                                               \n         item_noPOG5RP1P.AJR item_noPP.020.020.030 item_noVL.EC.PD.82515\n1  ( 1 )                                                                \n1  ( 2 )                                                                \n2  ( 1 )                                                                \n2  ( 2 )                                                                \n3  ( 1 )                                                                \n3  ( 2 )                                                                \n4  ( 1 )                                                                \n4  ( 2 )                                                                \n5  ( 1 )                                                                \n5  ( 2 )                                                                \n6  ( 1 )                                                                \n6  ( 2 )                                                                \n7  ( 1 )                                                                \n7  ( 2 )                                                                \n8  ( 1 )                                                                \n8  ( 2 )                                                                \n9  ( 1 )                                                                \n9  ( 2 )                                                                \n         item_noXP.STD.16202 item_noXP.STD.16252 item_noXP.STD.20202\n1  ( 1 )                                                            \n1  ( 2 )                                                            \n2  ( 1 )                                                            \n2  ( 2 )                                                            \n3  ( 1 )                                                            \n3  ( 2 )                                                            \n4  ( 1 )                                                            \n4  ( 2 )                                                            \n5  ( 1 )                                                            \n5  ( 2 )                                                            \n6  ( 1 )                                                            \n6  ( 2 )                                                            \n7  ( 1 )                                                            \n7  ( 2 )                                                            \n8  ( 1 )                                                            \n8  ( 2 )                                                            \n9  ( 1 )                                                            \n9  ( 2 )                                                            \n         item_noXP.STD.20252 item_noXP.STD.24242 item_noXPH.STD.24242\n1  ( 1 )                                                             \n1  ( 2 )                                                             \n2  ( 1 )                                                             \n2  ( 2 )                                                             \n3  ( 1 )                                                             \n3  ( 2 )                                                             \n4  ( 1 )                                                             \n4  ( 2 )                                                             \n5  ( 1 )                                                             \n5  ( 2 )                                                             \n6  ( 1 )                                                             \n6  ( 2 )                                                             \n7  ( 1 )                                                             \n7  ( 2 )                                                             \n8  ( 1 )                                                             \n8  ( 2 )                                                             \n9  ( 1 )                                                             \n9  ( 2 )                                                             \n         sales_period in_season year_round up\n1  ( 1 )                                     \n1  ( 2 )                                     \n2  ( 1 )                                     \n2  ( 2 )                                     \n3  ( 1 )                                    *\n3  ( 2 )                                     \n4  ( 1 )                                    *\n4  ( 2 )                                    *\n5  ( 1 )                                    *\n5  ( 2 )                                    *\n6  ( 1 )                                    *\n6  ( 2 )                      *             *\n7  ( 1 )                      *             *\n7  ( 2 )                                    *\n8  ( 1 )                      *             *\n8  ( 2 )                      *             *\n9  ( 1 )                      *             *\n9  ( 2 )            *         *             *\n```\n:::\n:::\n\n\nnext step is to interpret the results\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrsq <- best_mod_summary$rsq\n\n# Get the number of predictors\nnum_predictors <- 1:length(rsq)\n\n# Plot the R-squared values against the number of predictors\nplot(num_predictors, rsq, type = \"b\",\n     xlab = \"Number of Predictors\",\n     ylab = \"R-squared\",\n     main = \"R-squared vs. Number of Predictors\")\n```\n\n::: {.cell-output-display}\n![](pi_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\nthe best model has item_no 154.2424 item_no a510004 item_no\n\nhttps://www.youtube.com/watch?v=6HCJGYYCPR0\n",
    "supporting": [
      "pi_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}